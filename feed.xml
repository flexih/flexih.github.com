<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>flexih's</title>
    <description>about code, about life.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Thu, 12 Oct 2017 12:23:42 +0800</pubDate>
    <lastBuildDate>Thu, 12 Oct 2017 12:23:42 +0800</lastBuildDate>
    <generator>Jekyll v3.5.2</generator>
    
      <item>
        <title>UINavigationBar iOS11适配问题</title>
        <description>&lt;p&gt;在适配iOS11的过程中遇到UINavigationBar的leftBarButtonItems, rightBarButtonItems设置后距离屏幕间距变大问题。&lt;/p&gt;

&lt;p&gt;UINavigationBar在iOS11上的视图层次发生了变化：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/navbar/navbar.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;BarButtonItems被包装到了_UIButtonBarStackView里。iOS11上BarButtonItems开始使用UILayoutGuide布局。&lt;/p&gt;

&lt;p&gt;来看leftBarButtonItems的约束：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/navbar/leftbar2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/navbar/leftbar1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看出leftBarButtonItems的leading，与BackButtonGuide的trailing相关，这里的约束就算BackButton宽度是0的时候，trailing然后起作用。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-objective-c&quot;&gt;[navigationbar.subviews enumerateObjectsUsingBlock:^(__kindof UIView * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
        if ([obj isKindOfClass:NSClassFromString(@&quot;_UINavigationBarContentView&quot;)]) {
            __block NSLayoutConstraint *c = nil;
            [obj.layoutGuides enumerateObjectsUsingBlock:^(__kindof UILayoutGuide * _Nonnull o, NSUInteger idx, BOOL * _Nonnull stop) {
                if ([o.identifier hasPrefix:@&quot;BackButtonGuide&quot;]) {
                    c = [o.trailingAnchor constraintEqualToAnchor:o.leadingAnchor constant:12]; //|←
                    c.identifier = [@&quot;BackButtonGuide&quot; stringByAppendingFormat:@&quot;(%p)&quot;,c];
                    c.priority = UILayoutPriorityRequired;
                    *stop = true;
                }
            }];
            if (c) {
                [obj.constraints enumerateObjectsUsingBlock:^(__kindof NSLayoutConstraint * _Nonnull o, NSUInteger idx, BOOL * _Nonnull stop) {
                    if (o.firstItem == c.firstItem &amp;amp;&amp;amp; o.firstAttribute == c.firstAttribute) {
                        [o setActive:false];
                        [c setActive:true];
                        *stop = true;
                    }
                }];
            }
            *stop = true;
        }
    }];
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rightBarButtonItems的约束：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/navbar/rightbar1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-objective-c&quot;&gt;    [navigationbar.subviews enumerateObjectsUsingBlock:^(__kindof UIView * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
        if ([obj isKindOfClass:NSClassFromString(@&quot;_UINavigationBarContentView&quot;)]) {
            __block NSLayoutConstraint *c = nil;
            [obj.layoutGuides enumerateObjectsUsingBlock:^(__kindof UILayoutGuide * _Nonnull o, NSUInteger idx, BOOL * _Nonnull stop) {
                if ([o.identifier hasPrefix:@&quot;TrailingBarGuide&quot;]) {
                    c = [o.trailingAnchor constraintEqualToAnchor:obj.trailingAnchor constant:-12]; //→|
                    c.identifier = [@&quot;TrailingBarGuide&quot; stringByAppendingFormat:@&quot;(%p)&quot;,c];
                    c.priority = UILayoutPriorityRequired;
                    *stop = true;
                }
            }];
            if (c) {
                [obj.constraints enumerateObjectsUsingBlock:^(__kindof NSLayoutConstraint * _Nonnull o, NSUInteger idx, BOOL * _Nonnull stop) {
                    if (o.firstItem == c.firstItem &amp;amp;&amp;amp; o.firstAttribute == c.firstAttribute) {
                        [o setActive:false];
                        [c setActive:true];
                        *stop = true;
                    }
                }];
            }
            *stop = true;
        }
    }];
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;PS:注意到_UIButtonBarStackView内部还存在约束冲突的错误。。。&lt;/p&gt;
</description>
        <pubDate>Thu, 12 Oct 2017 12:21:00 +0800</pubDate>
        <link>http://localhost:4000/2017/10/12/UINavigationBar-iOS11%E9%80%82%E9%85%8D%E9%97%AE%E9%A2%98/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/12/UINavigationBar-iOS11%E9%80%82%E9%85%8D%E9%97%AE%E9%A2%98/</guid>
        
        <category>iOS11</category>
        
        <category>UINavigationBar</category>
        
        
      </item>
    
      <item>
        <title>关于空气</title>
        <description>&lt;p&gt;去年（2016年）春节后上班公司搬到了新装修的办公室。&lt;/p&gt;

&lt;p&gt;刚开始并没有明显的不适，直到有一天晚上要下班的时候，突然感觉头晕不太舒服，怀疑是甲醛引起的，第二天在家歇了一天。&lt;/p&gt;

&lt;p&gt;之后又搬到了新房住，住进去的时候已经放味将近一年了。然后噩梦就此开始。白天公司吸甲醛，晚上家里吸甲醛。终于某天周六加班的时候，突然开始流鼻血。但是还是坐在窗户旁边，窗户也打开着。之后就是偶尔流鼻血然后结痂然后又流鼻血。&lt;/p&gt;

&lt;p&gt;某周末在家吃完午饭的时候，我说好像今天没什么味了，蹭到门边使劲闻了一下，然后鼻子就流血了。赶紧去医院查了一下血，没什么问题。&lt;/p&gt;

&lt;p&gt;直到某天夜里睡觉流鼻血吓醒，说服家人搬出新房出去租房。在入住和搬离时都做了检测（淘宝上的实验室检测）。&lt;/p&gt;

&lt;p&gt;期间把板材家具卖掉，换了木蜡油实木家具。一年后入住，入住前找具有DMTC资质的机构（空气堡）检测了下，结果是客厅甲醛和TVOC依然超标，不过只超标了一点。怀疑是三层实木复合地板引起的（因为是地暖没法用实木地板），没能说服家人把地板拆掉换地砖。没办法只能入住，除非雾霾特别大其他时候都开窗通风。也用小米净化器+米皮制作了正压新风，不得不说米皮是个特别天才的创意。雾霾天的时候屋里的PM2.5能保持在10以下（强烈推荐）。之前同时开3台净化器都达不到这效果。但是会造成屋内二氧化碳过多，会感觉闷。可能是新风量不足，准备再放一个“小米新风”试试能不能缓解。说到新风不得不说之前给卧室装了一个松下壁挂新风，这个东西跟“小米新风”比起来差多了，风量小，而且用了几个月了还是一股塑料味。只是它是热交换，可能冬天的时候能排上用场。&lt;/p&gt;

&lt;p&gt;去年底换了新公司，没来多久就搬到新装修的楼层了，跟领导申请不搬去新楼层。跟团队脱离几个月后，终于搬下去了。搬下来后，在屋里待一会就身上会痒，戴着口罩鼻子也会疼。还好离开这些症状就消失了，只能慢慢适应了。&lt;/p&gt;
</description>
        <pubDate>Thu, 21 Sep 2017 10:52:00 +0800</pubDate>
        <link>http://localhost:4000/2017/09/21/%E5%85%B3%E4%BA%8E%E7%A9%BA%E6%B0%94/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/21/%E5%85%B3%E4%BA%8E%E7%A9%BA%E6%B0%94/</guid>
        
        <category>雾霾</category>
        
        <category>甲醛</category>
        
        <category>新风</category>
        
        
      </item>
    
  </channel>
</rss>
