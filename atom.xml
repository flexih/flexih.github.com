<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Tao</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.otao.me/"/>
  <updated>2016-11-25T02:48:03.000Z</updated>
  <id>http://www.otao.me/</id>
  
  <author>
    <name>flexih</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Set的误用</title>
    <link href="http://www.otao.me/2016/11/25/set/"/>
    <id>http://www.otao.me/2016/11/25/set/</id>
    <published>2016-11-25T02:19:08.000Z</published>
    <updated>2016-11-25T02:48:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>发现项目中有一处对NSMutableSet的误用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">@interface Model</div><div class="line">@property (nonnull, nonatomic, copy) NSURL *URL;</div><div class="line">@property (nonatomic, copy) NSString *value;</div><div class="line">@end</div><div class="line"></div><div class="line">@implementation Model</div><div class="line">- (NSUInteger)hash &#123;</div><div class="line">    return self.URL.hash;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (BOOL)isEqual:(id)object &#123;</div><div class="line">  if (self == object) &#123;</div><div class="line">    return true;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  return [self.URL isEqual:object.URL];</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure></p>
<p>使用的时候会多次添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Model *m1 = [Model new];</div><div class="line">m1.URL = [NSURL URLWithString:@&quot;http://www.youku.com&quot;];</div><div class="line">m1.value = @&quot;1&quot;;</div><div class="line"></div><div class="line">Model *m2 = [Model new];</div><div class="line">m2.URL = [NSURL URLWithString:@&quot;http://www.youku.com&quot;];</div><div class="line">m2.value = @&quot;2&quot;;</div><div class="line"></div><div class="line">NSMutableSet *set = [NSMutableSet set];</div><div class="line">[set addObject:m1];</div><div class="line">...</div><div class="line">[set addObject:m2];</div></pre></td></tr></table></figure>
<p>这里期望Model值相同的时候会覆盖添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//Adds a given object to the set, if it is not already a member.</div><div class="line">- (void)addObject:(ObjectType)object;</div></pre></td></tr></table></figure>
<p>如果值相同会忽略。</p>
<p>所以不会覆盖原值而是丢弃新值。在期望覆盖的场景先移除旧值再添加新值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[set removeObject:m2];</div><div class="line">[set addObject:m2];</div></pre></td></tr></table></figure>
<p><strong>PS:这种场景更适合用Dictionary，以Model.URL为key，Model为value。</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;发现项目中有一处对NSMutableSet的误用。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line
    
    </summary>
    
    
      <category term="Set Dictionary iOS" scheme="http://www.otao.me/tags/Set-Dictionary-iOS/"/>
    
  </entry>
  
  <entry>
    <title>IT花销</title>
    <link href="http://www.otao.me/2016/11/24/AppBoughts/"/>
    <id>http://www.otao.me/2016/11/24/AppBoughts/</id>
    <published>2016-11-24T10:19:22.000Z</published>
    <updated>2016-11-24T11:05:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>购买正版软件和服务的风气的形成有利于IT行业的良性发展，对程序员也是大有益处。以下是我自己的花销明细。</p>
<h2 id="订阅"><a href="#订阅" class="headerlink" title="订阅"></a>订阅</h2><ul>
<li>Github Personal Plan</li>
<li>Eureka</li>
<li>腾讯视频会员</li>
</ul>
<h2 id="Mac-app"><a href="#Mac-app" class="headerlink" title="Mac app"></a>Mac app</h2><ul>
<li>Reveal, Reveal 2</li>
<li>Sketch</li>
<li>Hopper</li>
<li>1Password</li>
<li>Alfred 2</li>
<li>Charles 4</li>
<li>CleanMyMac 2, 3</li>
<li>iStat Menus</li>
<li>ScreenFlow</li>
<li>Airmail</li>
<li>Popclip</li>
<li>Calcbot</li>
<li>Dash</li>
<li>Divvy</li>
<li>Reeder 3</li>
<li>Flume</li>
<li>CurrencyX</li>
<li>bundle apps</li>
</ul>
<h2 id="iOS-app"><a href="#iOS-app" class="headerlink" title="iOS app"></a>iOS app</h2><ul>
<li>1Password</li>
<li>Dash</li>
<li>Reeder 2, 3</li>
<li>Tweetbot2, 3, 4</li>
<li>Calcbot</li>
<li>Apphop</li>
<li>纪念碑谷</li>
<li>地狱边境</li>
<li>Lara Croft GO</li>
<li>Clear, Moves等很少使用的</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;购买正版软件和服务的风气的形成有利于IT行业的良性发展，对程序员也是大有益处。以下是我自己的花销明细。&lt;/p&gt;
&lt;h2 id=&quot;订阅&quot;&gt;&lt;a href=&quot;#订阅&quot; class=&quot;headerlink&quot; title=&quot;订阅&quot;&gt;&lt;/a&gt;订阅&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Githu
    
    </summary>
    
    
  </entry>
  
</feed>
